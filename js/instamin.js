function init(){(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i))&&$(".photo").click(function(){}),$(".upghent").click(function(){photo=$(this),-1==upghented.indexOf(photo.attr("data-id"))&&(upghented=upghented.concat(photo.attr("data-id")),localStorage&&(localStorage.upghented=upghented),$("#ghent-meter").html(eval($("#ghent-meter").html())+1),$.post("/upghent/"+photo.attr("data-id")),-1==downghented.indexOf(photo.attr("data-id"))&&(downghented.remove(downghented.indexOf(photo.attr("data-id"))),localStorage&&(localStorage.downghented=downghented)))}),$(".downghent").click(function(){photo=$(this),-1==downghented.indexOf(photo.attr("data-id"))&&(downghented=downghented.concat(photo.attr("data-id")),localStorage&&(localStorage.downghented=downghented),$.post("/downghent/"+photo.attr("data-id")),$("#ghent-meter").html(eval($("#ghent-meter").html())-1),-1==upghented.indexOf(photo.attr("data-id"))&&(upghented.remove(upghented.indexOf(photo.attr("data-id"))),localStorage&&(localStorage.upghented=upghented)))})}function update(){"author"==instaghent.sortingMethod||("tag"==instaghent.sortingMethod?$.getJSON("/gf13/"+offset,null,function(t){$('<div class="picrow"></div>').appendTo("#pics"),photo_array=photo_array.concat(t),f(),offset+=10}):$.getJSON("/more/"+instaghent.sortingMethod+"/"+offset,null,function(t){$('<div class="picrow"></div>').appendTo("#pics"),photo_array=photo_array.concat(t),f(),offset+=10}))}function processPhotos(t){var e=$("div.picrow"),i=e.eq(0).innerWidth(),n=524,o=10,r=[];$.each(t,function(){var t=parseInt(612,10),e=parseInt(612,10);e!=n&&(t=Math.floor(t*(n/e))),r.push(t)});for(var a=0,s=0;s++<e.length;){var l=e.eq(s-1);l.empty();for(var d=0,h=0;i>1.1*h;)h+=r[a+d++]+2*o;var c=i/h,u=0;h=0;for(var p=Math.floor(n*c);d>u;){var f=t[a+u],g=Math.floor(r[a+u]*c);h+=g+2*o,function(){if(f){var t=$("<img/>",{title:"@"+f.author,"class":"photo",src:f.standard,width:g,height:p}).css("margin",o+"px"),e="/by/"+f.author+"/"+f.ID,i=$("<a/>",{href:e});i.append(t),l.append(i)}}(),u++}for(u=0;i>h;){var m=l.find("img:nth-child("+(u+1)+")");m.width(m.width()+1),u=(u+1)%d,h++}for(u=0;h>i;){var v=l.find("img:nth-child("+(u+1)+")");v.width(v.width()-1),u=(u+1)%d,h--}l.height(p+2*o),a+=d}}Array.prototype.indexOf||(Array.prototype.indexOf=function(t){for(var e=0;e<this.length;e++)if(this[e]===t)return e;return-1}),Array.prototype.remove=function(t,e){try{var i=this.slice((e||t)+1||this.length);return this.length=0>t?this.length+t:t,this.push.apply(this,i)}catch(n){console.log(n)}},localStorage||(localStorage=[]);var upghented=localStorage.upghented?localStorage.upghented.split(","):[],downghented=localStorage.downghented?localStorage.downghented.split(","):[],offset=10,photo_array=null,lastWidth=0,f=function(){lastWidth=$("div#picstest").innerWidth(),$("div.picrow").width(lastWidth),processPhotos(photo_array)};"author"==instaghent.sortingMethod?$.getJSON("/by-json/"+instaghent.author,null,function(t){photo_array=t,f()}):"tag"==instaghent.sortingMethod?$.getJSON("/gf13/0",null,function(t){photo_array=t,f()}):$.getJSON("/more/"+instaghent.sortingMethod+"/0",null,function(t){photo_array=t,$("#pics .picrow.init").remove(),f()}),$(window).resize(function(){{$("div#picstest").innerWidth()}f()}),$(window).scroll(function(){$(window).scrollTop()==$(document).height()-$(window).height()&&update()}),init();